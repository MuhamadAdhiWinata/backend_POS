model User {
  id         Int         @id @default(autoincrement())
  nama       String
  email      String      @unique
  password   String      @db.VarChar(255)
  no_hp      String?
  alamat     String?
  role       String       // admin, kasir, customer, dll
  status     String?      // aktif / nonaktif
  created_at DateTime?    @default(now())
  updated_at DateTime?    @updatedAt

  transaksi  Transaksi[]  @relation("UserTransaksi")
  produk     Product[]    @relation("UserProduct") // kalau user adalah yang input produk

  @@map("user")
}

model Kategori {
  id         Int         @id @default(autoincrement())
  nama       String
  status     String?      // aktif / nonaktif
  created_at DateTime?    @default(now())
  updated_at DateTime?    @updatedAt

  produk     Product[]

  @@map("kategori")
}

model Product {
  id           Int         @id @default(autoincrement())
  nama         String
  kategoriId   Int
  harga        Decimal      @db.Decimal(10, 2)
  stok         Int          @default(0)
  deskripsi    String?
  gambar       String?
  status       String?      // aktif / nonaktif
  userId       Int?
  created_at   DateTime?    @default(now())
  updated_at   DateTime?    @updatedAt

  kategori     Kategori     @relation(fields: [kategoriId], references: [id], onDelete: Cascade)
  user         User?        @relation("UserProduct", fields: [userId], references: [id])
  detailTransaksi DetailTransaksi[]

  @@map("product")
}

model Transaksi {
  id             Int               @id @default(autoincrement())
  id_user        Int
  total_harga    Decimal           @db.Decimal(12, 2)
  diskon         Decimal?          @db.Decimal(10, 2)
  status         String?           // pending / done / cancel
  created_at     DateTime?         @default(now())
  updated_at     DateTime?         @updatedAt

  user           User              @relation("UserTransaksi", fields: [id_user], references: [id])
  detailTransaksi DetailTransaksi[]

  @@map("transaksi")
}

model DetailTransaksi {
  id               Int        @id @default(autoincrement())
  id_transaksi     Int
  id_product       Int
  qty              Int
  harga_satuan     Decimal    @db.Decimal(10, 2)
  subtotal         Decimal    @db.Decimal(12, 2)

  transaksi        Transaksi  @relation(fields: [id_transaksi], references: [id], onDelete: Cascade)
  product          Product    @relation(fields: [id_product], references: [id], onDelete: Cascade)

  @@map("detail_transaksi")
}
